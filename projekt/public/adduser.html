<html>
<head>
<title>Registrierung</title>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/sha512.js"></script>
</head>
<body>
<!-- Formular anzeigen -->
<form id="formular" method="post">
<table>
<tr><td>Name:</td><td> <input id="name" type="text"></td></tr>
<tr><td>Email:</td><td> <input id="email" type="text"></td></tr>
<tr><td>Passwort:</td><td> <input id="pass" type="text"></td></tr>
</table>
<input type="submit" value="Abschicken">
</form>
 
<script>
   $('#formular').submit(function(event) {
		event.preventDefault(); //Default Methode aus Formular unterbinden
		
		/*
		* Pruefe das Formularfelder nicht leer sind
		*/
		if($('#name').val() != "" && $('#email').val() != "" && $('#pass').val() != ""){
			
			/*
			* POST value in data Objekt einfügen
			*/
			var salt = $('#pass').val() + $('#email').val();
			var hash = CryptoJS.SHA512(salt);
			var data = {name: $('#name').val(), email: $('#email').val(), pass: hash.toString()};
			
			/*
			* AJAX Post absenden vom Typ Jason Objekt
			* Bei Erfolg: alert ausgeben, Formularfelder leeren und GET auf /planeten ausfuehren. Json empfangen und in Tabelle ausgeben
			* Bei Misserfolg: alert ausgeben
			*/
			$.ajax({
				type: 'POST',
				url: '/adduser',
				data: JSON.stringify(data),
				contentType: 'application/json'
			}).done(function(){
				alert(data.name+' wurde hinzugefuegt.');
				formular.name.value = "";
				formular.email.value = "";
				formular.pass.value = "";
			}).fail(function(e){
				alert(data.name+' konnte nicht hinzugefuegt werden. ('+JSON.stringify(e)+')');
			});
		}else{
			alert(unescape("Bitte alle Felder ausf%FCllen")); //unescape: Umlaut uebersetzen
		}
	});
</script>
</body>
</html>